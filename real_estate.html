<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Rent vs. Buy Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="shared.css">
    <script src="shared.js"></script>
    <style>
        .breadcrumb {
            font-size: 0.8rem;
            color: var(--muted);
            margin-bottom: 0.5rem;
        }
        .breadcrumb a { color: var(--muted); text-decoration: none; }
        .breadcrumb a:hover { color: var(--accent); }

        .collapsible-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.6rem 1rem;
            background: var(--accent);
            color: #0c1222;
            border-radius: 10px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }
        .collapsible-bar:hover { filter: brightness(1.05); }
        .collapsible-bar .arrow { transition: transform 0.2s; }
        .collapsible-bar.collapsed .arrow { transform: rotate(-90deg); }
        .collapsible-content { margin-bottom: 1.5rem; }
        .collapsible-content.hidden { display: none; }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem 1.25rem;
        }
        .input-group { margin-bottom: 0; }
        .input-group label { margin-bottom: 0.35rem; }
        .input-inline {
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }
        .input-inline input { flex: 1; min-width: 0; }
        .input-inline .unit {
            font-size: 0.8rem;
            color: var(--muted);
            white-space: nowrap;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            margin: 1.25rem 0 0.75rem;
            padding-bottom: 0.35rem;
        }
        .section-title:first-of-type { margin-top: 0; }

        .btn-row {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        .btn-row .btn { flex: 1; }
        .btn-row .btn-secondary { flex: 0 0 auto; }

        .result-section {
            display: none;
            margin-top: 2rem;
        }
        .result-section.visible { display: block; }

        .result-summary {
            font-size: 1.05rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        .result-summary .highlight {
            color: var(--success);
            font-weight: 700;
        }

        .chart-container {
            background: var(--bg-subtle);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        .chart-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.75rem;
        }
        #costChart {
            width: 100%;
            height: 280px;
            display: block;
        }

        .table-wrap {
            overflow-x: auto;
            border: 1px solid var(--border);
            border-radius: 12px;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        .results-table th,
        .results-table td {
            padding: 0.6rem 0.85rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        .results-table th {
            font-weight: 600;
            color: var(--muted);
            background: var(--bg-subtle);
        }
        .results-table tr:last-child td { border-bottom: none; }
        .results-table td { color: var(--text); }
        .results-table .num { font-family: "JetBrains Mono", monospace; text-align: right; }
        .table-caption {
            font-size: 0.85rem;
            color: var(--muted);
            margin-bottom: 0.5rem;
        }
    </style>
</head>

<body class="tool-page">
    <a href="index.html" class="nav-float" title="Home">☰</a>
    <div class="app">
        <aside class="sidebar">
            <h2>Explorer</h2>
            <div class="sidebar-section">
                <div class="sidebar-label">Navigate</div>
                <div class="tool-links">
                    <a class="tool-link" href="index.html">Home</a>
                </div>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-label">Civil Engineering</div>
                <div class="tool-links">
                    <a class="tool-link" href="elastic.html">Elastic constants</a>
                    <a class="tool-link" href="unit.html">Unit conversion</a>
                    <a class="tool-link" href="pdf-editor.html">PDF editor</a>
                </div>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-label">Personal Finance</div>
                <div class="tool-links">
                    <a class="tool-link" href="compound_interest.html">Compound Interest</a>
                    <a class="tool-link active" href="real_estate.html">Real Estate</a>
                    <a class="tool-link" href="passive_income.html">Passive Income</a>
                    <a class="tool-link" href="phd_decision.html">PhD Decision</a>
                    <a class="tool-link" href="save_vs_graduate.html">Save vs Graduate</a>
                </div>
            </div>
        </aside>
        <main class="main">
            <div class="container">
                <nav class="breadcrumb">
                    <a href="index.html">home</a> / <a href="index.html">financial</a> / rent vs. buy calculator
                </nav>
                <h1>Rent vs. Buy Calculator</h1>

                <div class="collapsible-bar collapsed" id="hintBar" onclick="toggleHint()">
                    <span>Modify the values and click the Calculate button to use</span>
                    <span class="arrow">▼</span>
                </div>
                <div class="collapsible-content hidden" id="hintContent">
                    <p class="subtitle" style="margin-bottom:0;">Enter your home purchase assumptions, rental costs, and tax info. The calculator compares average monthly cost of buying vs. renting over 1–30 years and shows when buying becomes cheaper.</p>
                </div>

                <div class="card">
                    <div class="section-title">Home Purchase</div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Home price</label>
                            <div class="input-inline">
                                <input type="number" id="homePrice" value="500000" min="0" step="1000">
                                <span class="unit">$</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Down payment</label>
                            <div class="input-inline">
                                <input type="number" id="downPct" value="20" min="0" max="100" step="1">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Interest rate</label>
                            <div class="input-inline">
                                <input type="number" id="interestRate" value="6.128" min="0" step="0.01">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Loan term</label>
                            <div class="input-inline">
                                <input type="number" id="loanTerm" value="30" min="1" max="30">
                                <span class="unit">years</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Buying closing costs</label>
                            <div class="input-inline">
                                <input type="number" id="buyClosingPct" value="2" min="0" step="0.5">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Property tax</label>
                            <div class="input-inline">
                                <input type="number" id="propTaxPct" value="1.5" min="0" step="0.1">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Property tax increase</label>
                            <div class="input-inline">
                                <input type="number" id="propTaxIncreasePct" value="3" min="0" step="0.5">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Home insurance</label>
                            <div class="input-inline">
                                <input type="number" id="homeInsurance" value="2500" min="0" step="100">
                                <span class="unit">$ / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>HOA fee</label>
                            <div class="input-inline">
                                <input type="number" id="hoaFee" value="0" min="0" step="100">
                                <span class="unit">$ / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Maintenance cost</label>
                            <div class="input-inline">
                                <input type="number" id="maintenancePct" value="1.5" min="0" step="0.1">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Home value appreciation</label>
                            <div class="input-inline">
                                <input type="number" id="appreciationPct" value="3" min="-10" step="0.5">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Cost/insurance increase</label>
                            <div class="input-inline">
                                <input type="number" id="costIncreasePct" value="3" min="0" step="0.5">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Selling closing costs</label>
                            <div class="input-inline">
                                <input type="number" id="sellClosingPct" value="7" min="0" step="0.5">
                                <span class="unit">%</span>
                            </div>
                        </div>
                    </div>

                    <div class="section-title">Home Rent</div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Monthly rental fee</label>
                            <div class="input-inline">
                                <input type="number" id="monthlyRent" value="3000" min="0" step="50">
                                <span class="unit">$</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Rental fee increase</label>
                            <div class="input-inline">
                                <input type="number" id="rentIncreasePct" value="3" min="0" step="0.5">
                                <span class="unit">% / year</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Renter's insurance</label>
                            <div class="input-inline">
                                <input type="number" id="renterInsurance" value="15" min="0" step="5">
                                <span class="unit">$ / month</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Security deposit</label>
                            <div class="input-inline">
                                <input type="number" id="securityDeposit" value="3000" min="0" step="100">
                                <span class="unit">$</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Upfront cost</label>
                            <div class="input-inline">
                                <input type="number" id="upfrontCost" value="100" min="0" step="50">
                                <span class="unit">$</span>
                            </div>
                        </div>
                    </div>

                    <div class="section-title">Your Information</div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Average investment return</label>
                            <div class="input-inline">
                                <input type="number" id="investmentReturnPct" value="5" min="0" step="0.5">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Marginal federal tax rate</label>
                            <div class="input-inline">
                                <input type="number" id="federalTaxPct" value="25" min="0" max="100" step="1">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Marginal state tax rate</label>
                            <div class="input-inline">
                                <input type="number" id="stateTaxPct" value="0" min="0" max="100" step="1">
                                <span class="unit">%</span>
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Tax filing status</label>
                            <select id="filingStatus">
                                <option value="single">single</option>
                                <option value="married_jointly" selected>married filing jointly</option>
                                <option value="married_separately">married filing separately</option>
                                <option value="head_of_household">head of household</option>
                            </select>
                        </div>
                    </div>

                    <div class="btn-row">
                        <button class="btn" onclick="calculate()">▶ Calculate</button>
                        <button class="btn btn-secondary" onclick="clearAll()">Clear</button>
                    </div>
                </div>

                <div class="result-section" id="resultSection">
                    <div class="result-summary" id="resultSummary"></div>
                    <div class="chart-container">
                        <div class="chart-title">Average Monthly Cost</div>
                        <canvas id="costChart" width="800" height="280"></canvas>
                    </div>
                    <p class="table-caption">The following is the average cost based on the length you stay for the next 30 years.</p>
                    <div class="table-wrap">
                        <table class="results-table" id="resultsTable">
                            <thead>
                                <tr>
                                    <th>Staying Length</th>
                                    <th class="num">Average Buying Cost (Monthly)</th>
                                    <th class="num">Average Buying Cost (Annual)</th>
                                    <th class="num">Average Renting Cost (Monthly)</th>
                                    <th class="num">Average Renting Cost (Annual)</th>
                                </tr>
                            </thead>
                            <tbody id="resultsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        function toggleHint() {
            const bar = document.getElementById('hintBar');
            const content = document.getElementById('hintContent');
            bar.classList.toggle('collapsed');
            content.classList.toggle('hidden');
        }

        function getNum(id, defaultVal = 0) {
            const v = parseFloat(document.getElementById(id).value);
            return isNaN(v) ? defaultVal : v;
        }

        function pmt(ratePerMonth, numPayments, principal) {
            if (ratePerMonth === 0) return principal / numPayments;
            return principal * (ratePerMonth * Math.pow(1 + ratePerMonth, numPayments)) /
                (Math.pow(1 + ratePerMonth, numPayments) - 1);
        }

        function getRemainingBalance(principal, ratePerMonth, numPayments, monthsPaid) {
            if (ratePerMonth === 0) return principal * (1 - monthsPaid / numPayments);
            const payment = pmt(ratePerMonth, numPayments, principal);
            return principal * Math.pow(1 + ratePerMonth, monthsPaid) -
                payment * (Math.pow(1 + ratePerMonth, monthsPaid) - 1) / ratePerMonth;
        }

        function getInterestPaidInYear(principal, ratePerMonth, numPayments, year) {
            const startMonth = year * 12;
            const endMonth = (year + 1) * 12;
            let total = 0;
            const payment = pmt(ratePerMonth, numPayments, principal);
            let bal = getRemainingBalance(principal, ratePerMonth, numPayments, startMonth);
            for (let m = startMonth; m < endMonth && m < numPayments; m++) {
                const interest = bal * ratePerMonth;
                total += interest;
                bal -= (payment - interest);
            }
            return total;
        }

        function calculate() {
            const price = getNum('homePrice', 500000);
            const downPct = getNum('downPct', 20) / 100;
            const interestRate = getNum('interestRate', 6.128) / 100;
            const loanTerm = getNum('loanTerm', 30);
            const buyClosingPct = getNum('buyClosingPct', 2) / 100;
            const propTaxPct = getNum('propTaxPct', 1.5) / 100;
            const propTaxIncreasePct = getNum('propTaxIncreasePct', 3) / 100;
            const homeInsurance = getNum('homeInsurance', 2500);
            const hoaFee = getNum('hoaFee', 0);
            const maintenancePct = getNum('maintenancePct', 1.5) / 100;
            const appreciationPct = getNum('appreciationPct', 3) / 100;
            const costIncreasePct = getNum('costIncreasePct', 3) / 100;
            const sellClosingPct = getNum('sellClosingPct', 7) / 100;

            const monthlyRent = getNum('monthlyRent', 3000);
            const rentIncreasePct = getNum('rentIncreasePct', 3) / 100;
            const renterInsurance = getNum('renterInsurance', 15);
            const securityDeposit = getNum('securityDeposit', 3000);
            const upfrontCost = getNum('upfrontCost', 100);

            const investmentReturn = getNum('investmentReturnPct', 5) / 100;
            const federalTax = getNum('federalTaxPct', 25) / 100;
            const stateTax = getNum('stateTaxPct', 0) / 100;

            const downPayment = price * downPct;
            const loanAmount = price - downPayment;
            const numPayments = loanTerm * 12;
            const ratePerMonth = interestRate / 12;
            const monthlyPandI = pmt(ratePerMonth, numPayments, loanAmount);
            const buyClosing = price * buyClosingPct;

            const buyCostByYear = [];
            const rentCostByYear = [];

            for (let years = 1; years <= 30; years++) {
                let propTax = price * propTaxPct;
                let ins = homeInsurance;
                let maint = price * maintenancePct;
                let totalBuyCost = downPayment + buyClosing;
                let totalInterest = 0;
                let totalPropTax = 0;

                for (let y = 0; y < years; y++) {
                    const yearPrincipal = getRemainingBalance(loanAmount, ratePerMonth, numPayments, y * 12);
                    const yearInterest = getInterestPaidInYear(loanAmount, ratePerMonth, numPayments, y);
                    totalInterest += yearInterest;
                    totalPropTax += propTax;
                    totalBuyCost += monthlyPandI * 12 + propTax + ins + hoaFee + maint;
                    propTax *= (1 + propTaxIncreasePct);
                    ins *= (1 + costIncreasePct);
                    const homeVal = price * Math.pow(1 + appreciationPct, y + 1);
                    maint = homeVal * maintenancePct;
                }

                const homeValueAtSale = price * Math.pow(1 + appreciationPct, years);
                const sellingCost = homeValueAtSale * sellClosingPct;
                const remainingBal = getRemainingBalance(loanAmount, ratePerMonth, numPayments, years * 12);
                const netFromSale = homeValueAtSale - sellingCost - remainingBal;
                const taxBenefit = (totalInterest + totalPropTax) * (federalTax + stateTax);
                const netBuyCost = totalBuyCost - netFromSale - taxBenefit;

                const avgBuyMonthly = Math.max(0, netBuyCost) / (years * 12);
                buyCostByYear.push(avgBuyMonthly);

                let totalRentCost = upfrontCost + securityDeposit;
                let rent = monthlyRent;
                let rentIns = renterInsurance * 12;
                for (let y = 0; y < years; y++) {
                    totalRentCost += rent * 12 + rentIns;
                    rent *= (1 + rentIncreasePct);
                    rentIns *= (1 + rentIncreasePct);
                }
                const opportunityCost = (downPayment + buyClosing) * (Math.pow(1 + investmentReturn, years) - 1);
                totalRentCost += opportunityCost;
                const avgRentMonthly = totalRentCost / (years * 12);
                rentCostByYear.push(avgRentMonthly);
            }

            let breakEvenYears = null;
            for (let i = 0; i < 30; i++) {
                if (buyCostByYear[i] <= rentCostByYear[i]) {
                    if (i === 0) {
                        breakEvenYears = 1;
                    } else {
                        const diffPrev = rentCostByYear[i - 1] - buyCostByYear[i - 1];
                        const diffCurr = rentCostByYear[i] - buyCostByYear[i];
                        const t = diffPrev - diffCurr !== 0 ? diffPrev / (diffPrev - diffCurr) : 1;
                        breakEvenYears = i + Math.max(0, Math.min(1, t));
                    }
                    break;
                }
            }

            const summaryEl = document.getElementById('resultSummary');
            if (breakEvenYears != null) {
                summaryEl.innerHTML = 'Buying is cheaper if you stay for <span class="highlight">' + breakEvenYears.toFixed(1) + ' years</span> or longer. Otherwise, renting is cheaper.';
            } else {
                summaryEl.innerHTML = 'Renting is cheaper over the next 30 years for these inputs.';
            }

            const tbody = document.getElementById('resultsTableBody');
            tbody.innerHTML = '';
            const fmt = (x) => '$' + Math.round(x).toLocaleString();
            for (let i = 0; i < 30; i++) {
                const tr = document.createElement('tr');
                tr.innerHTML =
                    '<td>' + (i + 1) + ' Year' + (i === 0 ? '' : 's') + '</td>' +
                    '<td class="num">' + fmt(buyCostByYear[i]) + '</td>' +
                    '<td class="num">' + fmt(buyCostByYear[i] * 12) + '</td>' +
                    '<td class="num">' + fmt(rentCostByYear[i]) + '</td>' +
                    '<td class="num">' + fmt(rentCostByYear[i] * 12) + '</td>';
                tbody.appendChild(tr);
            }

            drawChart(buyCostByYear, rentCostByYear);
            document.getElementById('resultSection').classList.add('visible');
        }

        function drawChart(buyCostByYear, rentCostByYear) {
            const canvas = document.getElementById('costChart');
            const rect = canvas.getBoundingClientRect();
            const dpr = window.devicePixelRatio || 1;
            canvas.width = Math.round(rect.width * dpr);
            canvas.height = Math.round(rect.height * dpr);
            const ctx = canvas.getContext('2d');
            ctx.scale(dpr, dpr);
            const w = rect.width;
            const h = rect.height;
            const padding = { top: 20, right: 20, bottom: 36, left: 52 };

            ctx.clearRect(0, 0, w, h);

            const all = buyCostByYear.concat(rentCostByYear).filter(x => isFinite(x) && x >= 0);
            const minY = 0;
            const maxY = Math.max(1, Math.ceil((Math.max(...all) || 1) / 1000) * 1000);

            const chartLeft = padding.left;
            const chartRight = w - padding.right;
            const chartTop = padding.top;
            const chartBottom = h - padding.bottom;
            const scaleX = (year) => chartLeft + (year / 30) * (chartRight - chartLeft);
            const scaleY = (val) => chartBottom - (val / maxY) * (chartBottom - chartTop);

            ctx.strokeStyle = 'rgba(71, 85, 105, 0.5)';
            ctx.lineWidth = 1;
            ctx.font = '11px DM Sans, sans-serif';
            ctx.fillStyle = 'var(--muted)';
            for (let y = 0; y <= maxY; y += 1000) {
                const sy = scaleY(y);
                ctx.beginPath();
                ctx.moveTo(chartLeft, sy);
                ctx.lineTo(chartRight, sy);
                ctx.stroke();
                const label = (y / 1000) + 'K';
                ctx.fillStyle = '#94a3b8';
                ctx.fillText(label, chartLeft - 8, sy + 4);
            }
            ctx.fillStyle = '#94a3b8';
            for (let x = 0; x <= 30; x += 5) {
                const sx = scaleX(x);
                ctx.fillText(x, sx - 6, chartBottom + 16);
            }
            ctx.fillText('Year', chartLeft + (chartRight - chartLeft) / 2 - 18, h - 8);
            ctx.save();
            ctx.translate(14, padding.top + (chartBottom - chartTop) / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Average Monthly Cost', 0, 0);
            ctx.restore();

            const drawLine = (data, color) => {
                ctx.beginPath();
                for (let i = 0; i < data.length; i++) {
                    const x = scaleX(i + 1);
                    const y = scaleY(Math.max(0, data[i]));
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.strokeStyle = color;
                ctx.lineWidth = 2.5;
                ctx.stroke();
            };
            drawLine(buyCostByYear, '#38bdf8');
            drawLine(rentCostByYear, '#34d399');

            ctx.font = '12px DM Sans, sans-serif';
            ctx.fillStyle = '#38bdf8';
            ctx.fillText('Buy', chartRight - 80, chartTop + 14);
            ctx.fillStyle = '#34d399';
            ctx.fillText('Rent', chartRight - 80, chartTop + 30);
        }

        function clearAll() {
            document.getElementById('homePrice').value = 500000;
            document.getElementById('downPct').value = 20;
            document.getElementById('interestRate').value = 6.128;
            document.getElementById('loanTerm').value = 30;
            document.getElementById('buyClosingPct').value = 2;
            document.getElementById('propTaxPct').value = 1.5;
            document.getElementById('propTaxIncreasePct').value = 3;
            document.getElementById('homeInsurance').value = 2500;
            document.getElementById('hoaFee').value = 0;
            document.getElementById('maintenancePct').value = 1.5;
            document.getElementById('appreciationPct').value = 3;
            document.getElementById('costIncreasePct').value = 3;
            document.getElementById('sellClosingPct').value = 7;
            document.getElementById('monthlyRent').value = 3000;
            document.getElementById('rentIncreasePct').value = 3;
            document.getElementById('renterInsurance').value = 15;
            document.getElementById('securityDeposit').value = 3000;
            document.getElementById('upfrontCost').value = 100;
            document.getElementById('investmentReturnPct').value = 5;
            document.getElementById('federalTaxPct').value = 25;
            document.getElementById('stateTaxPct').value = 0;
            document.getElementById('filingStatus').value = 'married_jointly';
            document.getElementById('resultSection').classList.remove('visible');
        }
    </script>
</body>

</html>
